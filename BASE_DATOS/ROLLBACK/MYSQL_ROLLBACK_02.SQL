-- CREAR UNA BASE DE DATOS
DROP DATABASE IF EXISTS BANCO;
CREATE DATABASE IF NOT EXISTS BANCO;

-- USAR UNA BASE DE DATOS
USE BANCO;

-- CREAR UNA TABLA
DROP TABLE IF EXISTS Cuenta;

CREATE TABLE Cuenta (
    id     INT          AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100),
    saldo  DECIMAL(10,2)
);

CREATE TABLE transacciones (
    id      INT AUTO_INCREMENT PRIMARY KEY,
    origen  INT           NOT NULL,
    destino INT           NOT NULL,
    monto   DECIMAL(10,2) NOT NULL,
    fecha   TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- INSERTAR REGISTROS EN UNA TABLA
INSERT INTO Cuenta (nombre, saldo) VALUES 
('Ana', 1000.00),
('Luis', 500.00);

SELECT * FROM Cuenta;

-- TRANSACCION: SECUENCIA DE OPERACIONES SQL QUE SE EJECUTAN COMO UNA SOLA UNIDAD DE TRABAJO
START TRANSACTION;

-- RESTAR 300 A ANA (USANDO ID QUE ES PRIMARY KEY, NO NECESITARIAS SAFE UPDATES AQUI)
UPDATE Cuenta SET saldo = saldo - 300 WHERE id = 1;

-- SUMAR 300 a LUIS (USANDO ID QUE ES PRIMARY KEY, NO NECESITARIAS SAFE UPDATES AQUI)
UPDATE Cuenta SET saldo = saldo + 300 WHERE id = 2;

-- CONFIRMAR LOS CAMBIOS
COMMIT;

-- VALIDACION EN UNA APP: EL SALDO ES NEGATIVO => ERROR. ENTONCES DESHACEMOS LOS CAMBIOS
ROLLBACK;